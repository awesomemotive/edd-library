---
layout: snippet
title: Force Login
description: Force users to be logged-in to download purchased files through Easy Digital Downloads
collection: misc
---

<?php
/*
 * Snippet Name: Easy Digital Downloads - Force Login to Download
 * Description: Force users to be logged-in to download purchased files through Easy Digital Downloads
 * Author: Easy Digital Downloads
 * Author URI: https://easydigitaldownloads.com/
 * Version: 2.0
 */
function eddwp_force_login_for_download( $has_access, $payment, $args ) {
	if(  ! is_user_logged_in() ) {
		ob_end_clean();
		$login_url = wp_login_url( trailingslashit( home_url() ) . '?' . $_SERVER['QUERY_STRING'] );
		$message = sprintf( 'You must be logged in to download files. <a href="%s">Login here</a>.', $login_url );
		wp_die( $message, 'Error' );
	}

	return $has_access;
}
add_filter( 'edd_file_download_has_access', 'eddwp_force_login_for_download', 10, 3 );
