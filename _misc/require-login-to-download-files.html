---
layout: snippet
title: Force Login
description: Force users to be logged-in to download purchased files through Easy Digital Downloads
collection: misc
---

<?php
/*
 * Snippet Name: Easy Digital Downloads - Force Login to Download
 * Description: Force users to be logged-in to download purchased files through Easy Digital Downloads
 * Author: Easy Digital Downloads
 * Author URI: https://easydigitaldownloads.com/
 * Version: 2.0
 */
function eddwp_force_login_for_download( $download_id, $email, $payment, $args ) {
	if (  ! is_user_logged_in() ) {
		$login_url = wp_login_url( trailingslashit( home_url() ) . '?' . $_SERVER['QUERY_STRING'] );
		$message = sprintf( 'You must be logged in to download files. <a href="%s">Login here</a>.', $login_url );
		wp_die( $message, 'Error' );
	}
}
add_action( 'edd_process_verified_download', 'eddwp_force_login_for_download', 10, 4 );
